const a0_0x4f6b00=a0_0x3662;(function(_0x2400a5,_0xe19c42){const _0x331db0=a0_0x3662,_0x2f890e=_0x2400a5();while(!![]){try{const _0x1459d6=parseInt(_0x331db0(0x207))/0x1*(-parseInt(_0x331db0(0x1f0))/0x2)+parseInt(_0x331db0(0x1ef))/0x3+-parseInt(_0x331db0(0x1ee))/0x4+-parseInt(_0x331db0(0x1fb))/0x5+parseInt(_0x331db0(0x228))/0x6+parseInt(_0x331db0(0x21e))/0x7*(-parseInt(_0x331db0(0x22f))/0x8)+parseInt(_0x331db0(0x22c))/0x9*(parseInt(_0x331db0(0x235))/0xa);if(_0x1459d6===_0xe19c42)break;else _0x2f890e['push'](_0x2f890e['shift']());}catch(_0x581005){_0x2f890e['push'](_0x2f890e['shift']());}}}(a0_0x16fb,0x498e1));const {Sequelize,DataTypes}=require('sequelize'),path=require(a0_0x4f6b00(0x20a)),fs=require('fs'),chokidar=require(a0_0x4f6b00(0x237));class AntiPmSpam{constructor(){const _0x39067c=a0_0x4f6b00;this[_0x39067c(0x1fe)]=new Map(),this['warningMessageIds']=new Map(),this['db']=null,this['PermittedUsers']=null,this[_0x39067c(0x1e6)]=![],this[_0x39067c(0x1e5)]=![],this[_0x39067c(0x211)]=null;}async[a0_0x4f6b00(0x1e7)](){const _0x5cad6b=a0_0x4f6b00;if(this[_0x5cad6b(0x1e5)])return;this[_0x5cad6b(0x1e5)]=!![];try{const _0x1a83ed=path['join'](__dirname,'..',_0x5cad6b(0x232));!fs[_0x5cad6b(0x22d)](_0x1a83ed)&&fs[_0x5cad6b(0x1ea)](_0x1a83ed,{'recursive':!![]});this['db']&&await this['db'][_0x5cad6b(0x223)]();this[_0x5cad6b(0x211)]&&await this[_0x5cad6b(0x211)]['close']();this['db']=new Sequelize({'dialect':'sqlite','storage':path[_0x5cad6b(0x1fa)](_0x1a83ed,'permitted_users.db'),'logging':![],'pool':{'max':0x5,'min':0x0,'acquire':0x7530,'idle':0x2710}}),this[_0x5cad6b(0x1f2)]=this['db'][_0x5cad6b(0x216)]('PermittedUsers',{'userId':{'type':DataTypes[_0x5cad6b(0x210)],'primaryKey':!![],'allowNull':![]},'permittedBy':{'type':DataTypes[_0x5cad6b(0x210)],'allowNull':![]},'reason':{'type':DataTypes['STRING'],'allowNull':!![]},'messageCount':{'type':DataTypes[_0x5cad6b(0x231)],'defaultValue':0x0,'allowNull':![]},'lastMessageTime':{'type':DataTypes[_0x5cad6b(0x230)],'allowNull':!![]}}),await this['db']['sync']();let _0x47b069;this[_0x5cad6b(0x211)]=chokidar[_0x5cad6b(0x22b)](path[_0x5cad6b(0x1fa)](_0x1a83ed,'permitted_users.db'),{'persistent':!![],'ignoreInitial':!![],'awaitWriteFinish':{'stabilityThreshold':0x7d0,'pollInterval':0x64}}),this['watcher']['on'](_0x5cad6b(0x217),async()=>{_0x47b069&&clearTimeout(_0x47b069),_0x47b069=setTimeout(async()=>{const _0xffd300=a0_0x3662;try{this['db'][_0xffd300(0x212)][_0xffd300(0x1f7)]&&await Promise[_0xffd300(0x1f9)](this['db'][_0xffd300(0x212)][_0xffd300(0x1f7)]['map'](_0x38f277=>{const _0x13de04=_0xffd300;return _0x38f277['cache']&&_0x38f277[_0x13de04(0x214)]['clear'](),Promise[_0x13de04(0x218)]();}));}catch(_0x9b9bb3){console['error'](_0xffd300(0x1fd),_0x9b9bb3);}},0x3e8);}),this[_0x5cad6b(0x1e6)]=!![];}catch(_0x155dcc){console['error'](_0x5cad6b(0x1ec),_0x155dcc);throw _0x155dcc;}finally{this[_0x5cad6b(0x1e5)]=![];}}async[a0_0x4f6b00(0x22e)](){const _0x4c5c4c=a0_0x4f6b00;return!this[_0x4c5c4c(0x1e6)]&&await this[_0x4c5c4c(0x1e7)](),!![];}async[a0_0x4f6b00(0x219)](_0x296cc2){const _0x3e5a0d=a0_0x4f6b00;await this[_0x3e5a0d(0x22e)]();try{const _0x5ec5a5=await this[_0x3e5a0d(0x1f2)][_0x3e5a0d(0x206)]({'where':{'userId':_0x296cc2}});return!!_0x5ec5a5;}catch(_0x1f034a){return console[_0x3e5a0d(0x1f6)](_0x3e5a0d(0x1eb),_0x1f034a),![];}}async[a0_0x4f6b00(0x234)](_0x16f452,_0x1fa06a,_0x39f518=''){const _0x27a6ad=a0_0x4f6b00;await this[_0x27a6ad(0x22e)]();try{const _0x205939=this['messageCounter']['get'](_0x16f452)||0x0;return await this['PermittedUsers'][_0x27a6ad(0x236)]({'userId':_0x16f452,'permittedBy':_0x1fa06a,'reason':_0x39f518,'messageCount':_0x205939,'lastMessageTime':new Date()}),this[_0x27a6ad(0x1fe)]['delete'](_0x16f452),this['warningMessageIds'][_0x27a6ad(0x204)](_0x16f452),!![];}catch(_0x4a0804){return console['error'](_0x27a6ad(0x20c),_0x4a0804),![];}}async[a0_0x4f6b00(0x22a)](_0x5d20df){const _0x349a06=a0_0x4f6b00;await this[_0x349a06(0x22e)]();try{return await this['PermittedUsers'][_0x349a06(0x213)]({'where':{'userId':_0x5d20df}}),this[_0x349a06(0x1fe)][_0x349a06(0x204)](_0x5d20df),this[_0x349a06(0x1fc)][_0x349a06(0x204)](_0x5d20df),!![];}catch(_0x51e4b9){return console['error'](_0x349a06(0x222),_0x51e4b9),![];}}async[a0_0x4f6b00(0x21f)](){const _0x379729=a0_0x4f6b00;await this[_0x379729(0x22e)]();try{const _0x485114=await this[_0x379729(0x1f2)][_0x379729(0x200)]();return _0x485114['map'](_0x533b50=>_0x533b50['dataValues']);}catch(_0x1a5d0a){return console[_0x379729(0x1f6)](_0x379729(0x20b),_0x1a5d0a),[];}}[a0_0x4f6b00(0x21c)](_0x4e7b2f,_0x2d634){const _0x12ad25=a0_0x4f6b00,_0x5c854a=_0x2d634-_0x4e7b2f;return'*⚠️\x20ANTI-PM\x20SPAM\x20WARNING*\x20\x0a\x0a'+_0x12ad25(0x1f3)+('```You\x20have\x20sent\x20'+_0x4e7b2f+'/'+_0x2d634+_0x12ad25(0x224))+(_0x12ad25(0x1f5)+_0x5c854a+_0x12ad25(0x203)+(_0x5c854a!==0x1?'s':'')+_0x12ad25(0x227))+_0x12ad25(0x201)+_0x12ad25(0x225)+'>\x20Thank\x20you\x20for\x20your\x20patience\x0a'+'>\x20®\x20KordAi\x20WhatsApp\x20Bot';}async[a0_0x4f6b00(0x21a)](_0x2cb263,_0x16b790){const _0x234ea6=a0_0x4f6b00;if(!await this[_0x234ea6(0x22e)]())return![];if(!global['settings']?.[_0x234ea6(0x226)]||!_0x16b790[_0x234ea6(0x1e8)]?.[_0x234ea6(0x208)]||_0x16b790[_0x234ea6(0x1e8)][_0x234ea6(0x208)][_0x234ea6(0x215)](_0x234ea6(0x1e9))||_0x16b790[_0x234ea6(0x1e8)][_0x234ea6(0x208)][_0x234ea6(0x215)](_0x234ea6(0x1f4))||_0x16b790[_0x234ea6(0x1e8)][_0x234ea6(0x208)]===_0x234ea6(0x1ff))return![];const _0x3f263f=_0x16b790[_0x234ea6(0x1e8)][_0x234ea6(0x208)],_0xe76495=global['settings']?.[_0x234ea6(0x229)]||'',_0x3b5c37=_0xe76495+_0x234ea6(0x20e);if(_0x3f263f===_0x2cb263[_0x234ea6(0x1f8)]['id']||_0x3f263f===_0x3b5c37||_0x16b790[_0x234ea6(0x1e8)][_0x234ea6(0x20f)])return![];if(await this[_0x234ea6(0x219)](_0x3f263f))return![];const _0x102be3=(this[_0x234ea6(0x1fe)][_0x234ea6(0x1f1)](_0x3f263f)||0x0)+0x1;this[_0x234ea6(0x1fe)][_0x234ea6(0x220)](_0x3f263f,_0x102be3);const _0x3e3b5d=global[_0x234ea6(0x221)]['ANTI_PM_SPAM_COUNT'],_0x33649f=this['getWarningMessage'](_0x102be3,_0x3e3b5d),_0x591d01=this[_0x234ea6(0x1fc)][_0x234ea6(0x1f1)](_0x3f263f);if(_0x591d01)await _0x2cb263[_0x234ea6(0x20d)](_0x3f263f,{'text':_0x33649f,'edit':_0x591d01});else{const _0x5c7bcd=await _0x2cb263[_0x234ea6(0x20d)](_0x3f263f,{'text':_0x33649f});this['warningMessageIds'][_0x234ea6(0x220)](_0x3f263f,_0x5c7bcd['key']);}const _0x2b19e2=_0x3e3b5d-_0x102be3;_0x2b19e2>0x0&&await _0x2cb263[_0x234ea6(0x20d)](_0x3f263f,{'text':'❗\x20'+_0x2b19e2+_0x234ea6(0x203)+(_0x2b19e2!==0x1?'s':'')+_0x234ea6(0x1ed),'edit':_0x16b790[_0x234ea6(0x1e8)]});if(_0x102be3>=_0x3e3b5d){const _0x2dfdd9=_0x234ea6(0x202);await _0x2cb263[_0x234ea6(0x20d)](_0x3f263f,{'text':_0x2dfdd9}),await _0x2cb263[_0x234ea6(0x21b)](_0x3f263f,'block'),this[_0x234ea6(0x1fe)][_0x234ea6(0x204)](_0x3f263f),this[_0x234ea6(0x1fc)]['delete'](_0x3f263f);const _0x41699d=_0x234ea6(0x233)+_0x3f263f[_0x234ea6(0x21d)]('@')[0x0]+_0x234ea6(0x209);return await _0x2cb263[_0x234ea6(0x20d)](_0x3b5c37,{'text':_0x41699d,'mentions':[_0x3f263f]}),!![];}return![];}}function a0_0x3662(_0x4c423c,_0x30057b){const _0x16fb5a=a0_0x16fb();return a0_0x3662=function(_0x3662e6,_0x5dfa08){_0x3662e6=_0x3662e6-0x1e5;let _0x55b5a0=_0x16fb5a[_0x3662e6];return _0x55b5a0;},a0_0x3662(_0x4c423c,_0x30057b);}function a0_0x16fb(){const _0x43098c=['```Further\x20messages\x20without\x20permission\x20will\x20result\x20in\x20being\x20blocked.```\x20\x0a\x0a','*🚫\x20ANTI-PM\x20SPAM*\x0a```You\x20have\x20exceeded\x20the\x20message\x20limit\x20and\x20my\x20owner\x20has\x20not\x20granted\x20permission.\x20You\x20will\x20be\x20blocked\x20immediately.```','\x20message','delete','exports','findOne','911SwvEEL','remoteJid','\x20for\x20exceeding\x20the\x20message\x20limit.','path','Error\x20fetching\x20permitted\x20users:','Error\x20permitting\x20user:','sendMessage','@s.whatsapp.net','fromMe','STRING','watcher','modelManager','destroy','cache','endsWith','define','change','resolve','isPermitted','handleMessage','updateBlockStatus','getWarningMessage','split','1364993jJTXJS','getAllPermittedUsers','set','settings','Error\x20revoking\x20permission:','close','\x20messages.```\x20\x0a','```Kindly\x20wait\x20for\x20my\x20owner\x27s\x20approval.```\x0a\x0a','ANTI_PM_SPAM','\x20remaining\x20before\x20being\x20blocked.```\x20\x0a','1365246kPbYsL','OWNER_NUMBERS','revoke','watch','9CRBCCB','existsSync','ensureInitialized','8AWaZov','DATE','INTEGER','Database','*🚫\x20ANTI-PM\x20SPAM*\x0aBlocked\x20user\x20@','permit','7884440eWKxGf','upsert','chokidar','isInitializing','isInitialized','initialize','key','@g.us','mkdirSync','Error\x20checking\x20permitted\x20status:','Failed\x20to\x20initialize\x20Anti\x20PM\x20Spam\x20database:','\x20remaining','172868gJilWE','795492DevzTb','378RXuspA','get','PermittedUsers','```Currently,\x20Anti-Spam\x20is\x20enabled\x20to\x20prevent\x20spam\x20on\x20DM.```\x20\x0a','@newsletter','```','error','models','user','all','join','2847365UmgQce','warningMessageIds','Error\x20in\x20watcher\x20callback:','messageCounter','status@broadcast','findAll'];a0_0x16fb=function(){return _0x43098c;};return a0_0x16fb();}const antiPmSpam=new AntiPmSpam();module[a0_0x4f6b00(0x205)]=antiPmSpam;