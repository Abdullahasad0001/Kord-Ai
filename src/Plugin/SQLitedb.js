const a0_0x7800e8=a0_0x1627;(function(_0x5eda54,_0x122071){const _0x536bc7=a0_0x1627,_0x1ab5c9=_0x5eda54();while(!![]){try{const _0x29df95=-parseInt(_0x536bc7(0x1ad))/0x1*(parseInt(_0x536bc7(0x1bf))/0x2)+-parseInt(_0x536bc7(0x18d))/0x3+-parseInt(_0x536bc7(0x1dd))/0x4+parseInt(_0x536bc7(0x1bb))/0x5*(parseInt(_0x536bc7(0x189))/0x6)+-parseInt(_0x536bc7(0x188))/0x7+-parseInt(_0x536bc7(0x193))/0x8*(-parseInt(_0x536bc7(0x198))/0x9)+parseInt(_0x536bc7(0x1b4))/0xa;if(_0x29df95===_0x122071)break;else _0x1ab5c9['push'](_0x1ab5c9['shift']());}catch(_0x4ca5c6){_0x1ab5c9['push'](_0x1ab5c9['shift']());}}}(a0_0x30b2,0x45a9a));function a0_0x1627(_0x1a5039,_0x3422aa){const _0x30b2e9=a0_0x30b2();return a0_0x1627=function(_0x162770,_0x5f5103){_0x162770=_0x162770-0x179;let _0x3aea8d=_0x30b2e9[_0x162770];return _0x3aea8d;},a0_0x1627(_0x1a5039,_0x3422aa);}const sqlite3=require(a0_0x7800e8(0x19e)),{open}=require(a0_0x7800e8(0x17f)),path=require(a0_0x7800e8(0x1cd)),chalk=require(a0_0x7800e8(0x194));class DatabaseManager{static async[a0_0x7800e8(0x1da)](_0x3a0f39){const _0x3c1368=a0_0x7800e8;await _0x3a0f39[_0x3c1368(0x1df)]('PRAGMA\x20journal_mode\x20=\x20WAL;'),await _0x3a0f39[_0x3c1368(0x1df)]('PRAGMA\x20synchronous\x20=\x20NORMAL;'),await _0x3a0f39[_0x3c1368(0x1df)](_0x3c1368(0x1d3)),await _0x3a0f39['exec'](_0x3c1368(0x180)),await _0x3a0f39[_0x3c1368(0x1df)](_0x3c1368(0x1a3)),await _0x3a0f39[_0x3c1368(0x1df)](_0x3c1368(0x181));}static async[a0_0x7800e8(0x1d7)](_0x2d7434){const _0x30ba31=a0_0x7800e8;await _0x2d7434[_0x30ba31(0x1df)](_0x30ba31(0x1b5));}}function a0_0x30b2(){const _0x1fa70a=['PRAGMA\x20page_count;','log','456351KOeOwI','length','prepare','remoteJid','messages.db','yellow','968CyYEjG','chalk','clearOldMessages','parse','now','25803wRLTXB','logger','warn','COMMIT','addToQueue','Database\x20integrity\x20check\x20failed','sqlite3','VACUUM;','min_timestamp_type','messages.upsert','isProcessingQueue','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_remoteJid\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ON\x20messages\x20(remoteJid)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','checkMessageStats','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20push_name\x20FROM\x20push_names\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20jid\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','toISOString','Database\x20connection\x20closed\x20successfully','shift','message','run','initialize','get','3210dEvXjZ','status@broadcast','integrity_check','green','queueProcessor','push','getPushName','8520020DdZndN','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20PRAGMA\x20optimize;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20PRAGMA\x20wal_checkpoint(TRUNCATE);\x0a\x20\x20\x20\x20\x20\x20\x20\x20','Error\x20initializing\x20SQLite\x20store:','@s.whatsapp.net','Database\x20health\x20check\x20failed:','exports','includes','5WMdSDv','processQueue','Operation\x20timeout\x20reached.\x20Will\x20resume\x20in\x20next\x20run.','all','126FhjKwE','SELECT\x20message\x20FROM\x20messages\x20WHERE\x20remoteJid\x20=\x20?\x20AND\x20id\x20=\x20?','close','writeMessage','pushNameQueue','SELECT\x20message\x20FROM\x20messages\x20WHERE\x20remoteJid\x20=\x20?\x20ORDER\x20BY\x20timestamp\x20DESC\x20LIMIT\x20?','split','SELECT\x201','VACUUM\x20operation\x20failed:','pushName','User','Error\x20getting\x20chat\x20history:','checkDatabaseHealth','healthy','path','stringify','getChatHistory','BEGIN\x20TRANSACTION','_cleanJid','floor','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20messages\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20remoteJid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20message\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20timestamp\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20pushName\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20participant\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20messageType\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20PRIMARY\x20KEY\x20(id,\x20remoteJid)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','page_size','\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20timestamp,\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20TYPEOF(timestamp)\x20as\x20timestamp_type\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20messages\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LIMIT\x205\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20','PRAGMA\x20integrity_check;','optimizeDatabase','red','pow','createSchema','Failed\x20to\x20clear\x20messages\x20after\x20','blue','1587648lkRbPU','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20INSERT\x20OR\x20REPLACE\x20INTO\x20messages\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(id,\x20remoteJid,\x20message,\x20timestamp,\x20pushName,\x20participant,\x20messageType)\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','exec','\x20failed:','toFixed','finalize','Error\x20checking\x20message\x20stats:','loadMessage','changes','DatabaseManager','Error\x20getting\x20pushName:\x20','Batch\x20deleted\x20','Error\x20processing\x20write\x20queue:','Running\x20database\x20optimization...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WITH\x20messages_to_delete\x20AS\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20messages\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20timestamp\x20<\x20?\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LIMIT\x20?\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20DELETE\x20FROM\x20messages\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20IN\x20(SELECT\x20id\x20FROM\x20messages_to_delete)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','push_name','writeQueue','findMessageById','Database\x20vacuum\x20completed\x20successfully','Error\x20loading\x20message:','sqlite','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20push_names\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20jid\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20push_name\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20last_updated\x20INTEGER\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_remoteJid_timestamp\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ON\x20messages\x20(remoteJid,\x20timestamp\x20DESC)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','ROLLBACK','\x20messages.\x20Total:\x20','Database\x20optimization\x20failed:','SELECT\x20message\x20FROM\x20messages\x20WHERE\x20id\x20=\x20?','error','min','3696154ATUVVt','2194260qwutNr','unshift'];a0_0x30b2=function(){return _0x1fa70a;};return a0_0x30b2();}class MessageQueueProcessor{constructor(_0x1963dd){const _0x379257=a0_0x7800e8;this['db']=_0x1963dd,this[_0x379257(0x17b)]=[],this[_0x379257(0x1c3)]=[],this[_0x379257(0x1a2)]=![];}async[a0_0x7800e8(0x1bc)](){const _0x5ef9fc=a0_0x7800e8;if(this[_0x5ef9fc(0x1a2)]||this[_0x5ef9fc(0x17b)][_0x5ef9fc(0x18e)]===0x0&&this[_0x5ef9fc(0x1c3)][_0x5ef9fc(0x18e)]===0x0)return;this[_0x5ef9fc(0x1a2)]=!![];try{await this['db'][_0x5ef9fc(0x1aa)](_0x5ef9fc(0x1d0));const _0x8fa5b5=await this['db'][_0x5ef9fc(0x18f)](_0x5ef9fc(0x1de)),_0xb529d4=await this['db'][_0x5ef9fc(0x18f)]('\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20INSERT\x20OR\x20REPLACE\x20INTO\x20push_names\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(jid,\x20push_name,\x20last_updated)\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20?)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20');while(this['writeQueue'][_0x5ef9fc(0x18e)]>0x0){const _0x49b1c2=this['writeQueue']['shift'](),{key:_0x37ad8d,messageTimestamp:_0x481b73,pushName:_0x4ca10b,participant:_0x4a94af,type:_0x53a868}=_0x49b1c2;await _0x8fa5b5[_0x5ef9fc(0x1aa)](_0x37ad8d['id'],_0x37ad8d['remoteJid'],JSON[_0x5ef9fc(0x1ce)](_0x49b1c2),_0x481b73,_0x4ca10b,_0x4a94af,_0x53a868);}while(this['pushNameQueue'][_0x5ef9fc(0x18e)]>0x0){const {jid:_0x24f54e,pushName:_0x220379}=this[_0x5ef9fc(0x1c3)][_0x5ef9fc(0x1a8)]();await _0xb529d4[_0x5ef9fc(0x1aa)](_0x24f54e,_0x220379,Math[_0x5ef9fc(0x1d2)](Date['now']()/0x3e8));}await _0x8fa5b5[_0x5ef9fc(0x1e2)](),await _0xb529d4['finalize'](),await this['db'][_0x5ef9fc(0x1aa)](_0x5ef9fc(0x19b));}catch(_0x26ac45){console['error'](chalk[_0x5ef9fc(0x1d8)](_0x5ef9fc(0x1e9),_0x26ac45)),await this['db'][_0x5ef9fc(0x1aa)](_0x5ef9fc(0x182));if(this[_0x5ef9fc(0x17b)]['length']===0x0)this[_0x5ef9fc(0x17b)][_0x5ef9fc(0x18a)](...this[_0x5ef9fc(0x17b)]);if(this[_0x5ef9fc(0x1c3)][_0x5ef9fc(0x18e)]===0x0)this['pushNameQueue'][_0x5ef9fc(0x18a)](...this[_0x5ef9fc(0x1c3)]);}finally{this[_0x5ef9fc(0x1a2)]=![],setTimeout(()=>this[_0x5ef9fc(0x1bc)](),0x64);}}[a0_0x7800e8(0x19c)](_0x15b38c){const _0x17fe6e=a0_0x7800e8;this[_0x17fe6e(0x17b)][_0x17fe6e(0x1b2)](_0x15b38c),!this[_0x17fe6e(0x1a2)]&&this[_0x17fe6e(0x1bc)]();}['addPushNameToQueue'](_0x114481,_0x2b6fbf){const _0x2b8cdc=a0_0x7800e8;this[_0x2b8cdc(0x1c3)][_0x2b8cdc(0x1b2)]({'jid':_0x114481,'pushName':_0x2b6fbf}),!this[_0x2b8cdc(0x1a2)]&&this[_0x2b8cdc(0x1bc)]();}}class SQLiteMessageStore{constructor(_0x343826){const _0x180318=a0_0x7800e8;this[_0x180318(0x199)]=_0x343826,this['db']=null,this[_0x180318(0x1b1)]=null;}async[a0_0x7800e8(0x1ab)](){const _0x3bbf4c=a0_0x7800e8;try{this['db']=await open({'filename':path['join'](__dirname,'..',_0x3bbf4c(0x191)),'driver':sqlite3['Database']}),await DatabaseManager['createSchema'](this['db']),this['queueProcessor']=new MessageQueueProcessor(this['db']);}catch(_0x301768){console[_0x3bbf4c(0x186)](chalk[_0x3bbf4c(0x1d8)](_0x3bbf4c(0x1b6),_0x301768));throw _0x301768;}}async['writeMessage'](_0xd86fbd){const _0x22a42a=a0_0x7800e8;this[_0x22a42a(0x1b1)][_0x22a42a(0x19c)](_0xd86fbd);if(_0xd86fbd[_0x22a42a(0x1c8)]){const _0x1801f2=this['_cleanJid'](_0xd86fbd['key']['participant']||_0xd86fbd['key'][_0x22a42a(0x190)]);_0x1801f2!==_0x22a42a(0x1ae)&&this[_0x22a42a(0x1b1)]['addPushNameToQueue'](_0x1801f2,_0xd86fbd[_0x22a42a(0x1c8)]);}}[a0_0x7800e8(0x1d1)](_0x159247){const _0x4595fe=a0_0x7800e8;return _0x159247[_0x4595fe(0x1ba)]('@')?_0x159247[_0x4595fe(0x1c5)]('@')[0x0]+_0x4595fe(0x1b7):_0x159247;}async[a0_0x7800e8(0x1b3)](_0x3c923e){const _0x3b1003=a0_0x7800e8;try{if(!_0x3c923e)return'User';const _0x785727=this['_cleanJid'](_0x3c923e),_0x15e046=await this['db'][_0x3b1003(0x1ac)](_0x3b1003(0x1a5),[_0x785727]);if(_0x15e046?.[_0x3b1003(0x17a)])return _0x15e046[_0x3b1003(0x17a)];const _0x2fc357=await this['db'][_0x3b1003(0x1ac)]('\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20pushName\x20FROM\x20messages\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20(remoteJid\x20=\x20?\x20OR\x20participant\x20=\x20?)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20AND\x20pushName\x20IS\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20AND\x20pushName\x20!=\x20\x27\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ORDER\x20BY\x20timestamp\x20DESC\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LIMIT\x201\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',[_0x785727,_0x785727]);return _0x2fc357?.[_0x3b1003(0x1c8)]||_0x785727[_0x3b1003(0x1c5)]('@')[0x0]||_0x3b1003(0x1c9);}catch(_0x584f7){return console[_0x3b1003(0x186)](_0x3b1003(0x1e7)+_0x584f7),'User';}}async[a0_0x7800e8(0x1a4)](){const _0x15a9fe=a0_0x7800e8;try{const _0x1feeac=await this['db'][_0x15a9fe(0x1be)](_0x15a9fe(0x1d5)),_0x28cb9d=await this['db'][_0x15a9fe(0x1ac)]('\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20COUNT(*)\x20as\x20total_count,\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20TYPEOF(MIN(timestamp))\x20as\x20min_timestamp_type,\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20TYPEOF(MAX(timestamp))\x20as\x20max_timestamp_type\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20messages\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20');return{'messageCount':_0x28cb9d['total_count'],'timestampTypes':{'min':_0x28cb9d[_0x15a9fe(0x1a0)],'max':_0x28cb9d['max_timestamp_type']},'samples':_0x1feeac};}catch(_0x499fd3){console['error'](_0x15a9fe(0x1e3),_0x499fd3);throw _0x499fd3;}}async[a0_0x7800e8(0x1e4)](_0x2f1371,_0x596f7b){const _0x3688e9=a0_0x7800e8;try{const _0x2517db=await this['db'][_0x3688e9(0x1ac)](_0x3688e9(0x1c0),[_0x2f1371,_0x596f7b]);return _0x2517db?JSON['parse'](_0x2517db[_0x3688e9(0x1a9)]):undefined;}catch(_0x1f7982){return console['error'](chalk[_0x3688e9(0x1d8)](_0x3688e9(0x17e),_0x1f7982)),undefined;}}async[a0_0x7800e8(0x17c)](_0x7378e9){const _0x9a3f88=a0_0x7800e8;try{const _0x3b03b7=await this['db'][_0x9a3f88(0x1ac)](_0x9a3f88(0x185),[_0x7378e9]);return _0x3b03b7?JSON[_0x9a3f88(0x196)](_0x3b03b7[_0x9a3f88(0x1a9)]):undefined;}catch(_0x472d77){return console['error'](chalk['red']('Error\x20finding\x20message\x20by\x20ID:',_0x472d77)),undefined;}}async[a0_0x7800e8(0x1cf)](_0x2eca22,_0x48270f=0x32){const _0x12baa8=a0_0x7800e8;try{return await this['db'][_0x12baa8(0x1be)](_0x12baa8(0x1c4),[_0x2eca22,_0x48270f]);}catch(_0x51c056){return console[_0x12baa8(0x186)](chalk[_0x12baa8(0x1d8)](_0x12baa8(0x1ca),_0x51c056)),[];}}async[a0_0x7800e8(0x195)](_0x4481ad=0x1,_0x2d5f67={}){const _0x1200fa=a0_0x7800e8,{batchSize:batchSize=0x3e8,maxAttempts:maxAttempts=0x3,vacuumThreshold:vacuumThreshold=0x1388,timeout:timeout=0x7530}=_0x2d5f67;let _0x20a936=0x0,_0xa1445b=0x0;const _0x4e6eff=Date[_0x1200fa(0x197)]();while(_0x20a936<maxAttempts){try{await this['db'][_0x1200fa(0x1aa)]('PRAGMA\x20busy_timeout\x20=\x20'+timeout+';');const _0x307880=Math['floor'](Date[_0x1200fa(0x197)]()/0x3e8)-_0x4481ad*0x18*0x3c*0x3c;let _0x3a286b;do{const _0x29aa8f=await this['db'][_0x1200fa(0x1aa)](_0x1200fa(0x179),[_0x307880,batchSize]);_0x3a286b=_0x29aa8f[_0x1200fa(0x1e5)],_0xa1445b+=_0x3a286b;_0x3a286b>0x0&&console[_0x1200fa(0x18c)](chalk[_0x1200fa(0x1dc)](_0x1200fa(0x1e8)+_0x3a286b+_0x1200fa(0x183)+_0xa1445b));if(Date[_0x1200fa(0x197)]()-_0x4e6eff>timeout){console['log'](chalk[_0x1200fa(0x192)](_0x1200fa(0x1bd)));break;}await new Promise(_0x467761=>setTimeout(_0x467761,0x64));}while(_0x3a286b===batchSize);if(_0xa1445b>=vacuumThreshold)try{console[_0x1200fa(0x18c)](chalk['blue'](_0x1200fa(0x1ea))),await this['db'][_0x1200fa(0x1aa)](_0x1200fa(0x19b)),await DatabaseManager[_0x1200fa(0x1d7)](this['db']);try{await this['db'][_0x1200fa(0x1aa)](_0x1200fa(0x19f)),console[_0x1200fa(0x18c)](chalk[_0x1200fa(0x1b0)](_0x1200fa(0x17d)));}catch(_0x4baa36){console[_0x1200fa(0x19a)](chalk[_0x1200fa(0x192)](_0x1200fa(0x1c7),_0x4baa36));}}catch(_0x22dee9){console[_0x1200fa(0x19a)](chalk[_0x1200fa(0x192)](_0x1200fa(0x184),_0x22dee9));}return console[_0x1200fa(0x18c)](chalk['green']('Successfully\x20cleared\x20'+_0xa1445b+'\x20old\x20messages')),{'success':!![],'messagesDeleted':_0xa1445b,'attempts':_0x20a936+0x1};}catch(_0x4c464c){_0x20a936++,console[_0x1200fa(0x186)](chalk[_0x1200fa(0x1d8)]('Cleanup\x20attempt\x20'+_0x20a936+_0x1200fa(0x1e0),_0x4c464c));if(_0x20a936>=maxAttempts)throw new Error(_0x1200fa(0x1db)+maxAttempts+'\x20attempts:\x20'+_0x4c464c[_0x1200fa(0x1a9)]);await new Promise(_0x2d7e8c=>setTimeout(_0x2d7e8c,Math[_0x1200fa(0x187)](0x3e8*Math[_0x1200fa(0x1d9)](0x2,_0x20a936),0x2710)));}}}async[a0_0x7800e8(0x1cb)](){const _0x41f077=a0_0x7800e8;try{await this['db'][_0x41f077(0x1ac)](_0x41f077(0x1c6));const _0xd24816=await this['db'][_0x41f077(0x1ac)](_0x41f077(0x1d6));if(_0xd24816[_0x41f077(0x1af)]!=='ok')throw new Error(_0x41f077(0x19d));const _0x400e4b=await this['db'][_0x41f077(0x1ac)](_0x41f077(0x18b)),_0x375cd9=await this['db']['get']('PRAGMA\x20page_size;'),_0x30d94e=_0x400e4b['page_count']*_0x375cd9[_0x41f077(0x1d4)]/(0x400*0x400);return{'status':_0x41f077(0x1cc),'sizeInMB':_0x30d94e[_0x41f077(0x1e1)](0x2),'lastChecked':new Date()[_0x41f077(0x1a6)]()};}catch(_0x251c96){console[_0x41f077(0x186)](chalk['red'](_0x41f077(0x1b8),_0x251c96));throw _0x251c96;}}async['bind'](_0x4cbdb7){const _0x4629e8=a0_0x7800e8;_0x4cbdb7['on'](_0x4629e8(0x1a1),async({messages:_0x40b44f})=>{const _0x17f61f=_0x4629e8;for(const _0x3070d5 of _0x40b44f){await this[_0x17f61f(0x1c2)](_0x3070d5);}});}async[a0_0x7800e8(0x1c1)](){const _0x3f1a42=a0_0x7800e8;try{this['db']&&(await this['db'][_0x3f1a42(0x1c1)](),console[_0x3f1a42(0x18c)](chalk[_0x3f1a42(0x1b0)](_0x3f1a42(0x1a7))));}catch(_0x49e6a6){console[_0x3f1a42(0x186)](chalk[_0x3f1a42(0x1d8)]('Error\x20closing\x20database\x20connection:',_0x49e6a6));}}}module['exports']=SQLiteMessageStore,module[a0_0x7800e8(0x1b9)][a0_0x7800e8(0x1e6)]=DatabaseManager;